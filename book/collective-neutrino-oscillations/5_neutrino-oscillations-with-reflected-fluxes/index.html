<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=content-security-policy content="default-src * self blob: data: gap:; style-src * 'unsafe-inline' blob: data: gap:; script-src * 'self' 'unsafe-eval' 'unsafe-inline' blob: data: gap:; object-src * 'self' blob: data: gap:; img-src * self 'unsafe-inline' blob: data: gap:; connect-src self * 'unsafe-inline' blob: data: gap:; frame-src * self blob: data: gap:; font-src 'self' * 'unsafe-inline' blob: data: gap:;"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=preconnect href=https://neutrino.leima.is><link rel=stylesheet href=/main.cfaff33de4e5150b4be3c9be6ad54e4ad0117cd2b699b1477aaef6ce8d2911dd7c0a04547894416d4028a4fde571092eeb05b54ecf2109ac72cb57eee9328dcc.css integrity="sha512-z6/zPeTlFQtL48m+atVOStARfNK2mbFHeq72zo0pEd18CgRUeJRBbUAopP3lcQku6wW1Ts8hCaxyy1fu6TKNzA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><style>figcaption{border-left:3px solid gray;padding-left:10px}</style><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Neutrino Oscillations with Reflected Fluxes - Neutrino Oscillations</title><meta name=description content="Neutrino Oscillations with Reflected Fluxes"><link rel=canonical href=/book/collective-neutrino-oscillations/5_neutrino-oscillations-with-reflected-fluxes/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/neutrinos.jpg"><meta name=twitter:title content="Neutrino Oscillations with Reflected Fluxes"><meta name=twitter:description content="Neutrino Oscillations with Reflected Fluxes"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="Neutrino Oscillations with Reflected Fluxes"><meta property="og:description" content="Neutrino Oscillations with Reflected Fluxes"><meta property="og:type" content="article"><meta property="og:url" content="/book/collective-neutrino-oscillations/5_neutrino-oscillations-with-reflected-fluxes/"><meta property="og:image" content="/neutrinos.jpg"><meta property="article:published_time" content="2020-04-20T11:53:07+02:00"><meta property="article:modified_time" content="2020-12-28T15:52:39+01:00"><meta property="og:site_name" content="Neutrino Oscillations"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"\/book\/collective-neutrino-oscillations\/5_neutrino-oscillations-with-reflected-fluxes\/"},"headline":"Neutrino Oscillations with Reflected Fluxes","image":[],"datePublished":"2020-04-20T11:53:07CET","dateModified":"2020-12-28T15:52:39CET","author":{"@type":"Organization","name":"Neutrino Oscillations"},"publisher":{"@type":"Organization","name":"Neutrino Oscillations","logo":{"@type":"ImageObject","url":"\/logo.png"}},"description":"Neutrino Oscillations with Reflected Fluxes"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Bookcollective Neutrino Oscillations5 Neutrino Oscillations With Reflected Fluxes","item":"\/bookcollective-neutrino-oscillations5_neutrino-oscillations-with-reflected-fluxes\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script>MathJax={loader:{load:['[tex]/tagformat']},tex:{inlineMath:[['$','$'],['\\(','\\)']],tags:'ams',packages:{'[+]':['tagformat']}},svg:{fontCache:'global'},tagformat:{number:(n)=>n.toString(),tag:(tag)=>'('+tag+')',id:(id)=>'eqn-'+id.replace(/\s/g,'_').replace(':','_').replace('%3A','_'),url:(id,base)=>base+'#'+encodeURIComponent(id),}};</script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({ TeX: { extensions: ["color.js","cancel.js", "AMSmath.js", "AMSsymbols.js"] }});
    </script><script type=text/x-mathjax-config>
  MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
    MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
       cancel: ["Extension","cancel"]
       });
    });
    </script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
       tex2jax: {
         preview: "none",
         skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
       }
    });
    </script><script type=text/x-mathjax-config>
  MathJax.Hub.Queue(function() {
         var all = MathJax.Hub.getAllJax(), i;
         for(i=0; i &lt; all.length; i += 1) {
             all[i].SourceElement().parentNode.className += ' has-jax';
         }
    });
    </script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
       processEscapes: true
    }
    });
    </script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    "fast-preview": {
    Chunks: {EqnChunk: 10000, EqnChunkFactor: 1, EqnChunkDelay: 0},
    color: "inherit!important",
    updateTime: 30, updateDelay: 6,
    messageStyle: "none",
    disabled: false
    }
    });
    </script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    TeX: {
       Macros: {
         overlr: ['\\overset\\leftrightarrow{\#1}',1],
         overl: ['\\overset\leftarrow{\#1}',1],
         overr: ['\\overset\rightarrow{\#1}',1],
         bra: ['\\left\\langle \#1\\right|',1],
         ket: ['\\left| \#1\\right\\rangle',1],
         braket: ['\\langle \#1 \\mid \#2 \\rangle',2],
         avg: ['\\left&lt; \#1 \\right>',1],
         slashed: ['\\cancel{\#1}',1],
         bold: ['\\boldsymbol{\#1}',1],
         sech: ['\\operatorname{sech}{\#1}',1],
         csch: ['\\operatorname{csch}{\#1}',1],
         Tr: ['\\operatorname{Tr}{\#1}',1],
         ud: ['{\#1^\\dagger', 1]
       }
    }
    });
    MathJax.InputJax.TeX.Macro('ff', '{\\mathrm f}');
    </script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><div style=display:none>$$
\newcommand\Tr{\mathrm{Tr}}
\newcommand{\braket}[2]{\langle #1 \mid #2 \rangle}
\newcommand\I{\mathbb{I}}
\newcommand{\avg}[1]{\left&lt; #1 \right>}
\newcommand{\RD}{D}
\newcommand{\ri}{\mathrm{i}}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Sign}{Sign}
\newcommand{\ii}{\mathrm i}
\newcommand{\vv}{\mathrm v}
\newcommand{\ff}{\mathrm f}
\newcommand{\mm}{\mathrm m}
\newcommand{\ee}{\mathrm e}
\newcommand{\xx}{\mathrm x}
\newcommand{\RR}{\mathrm R}
\newcommand{\dd}{\mathrm d}
\newcommand{\FF}{\mathrm F}
\newcommand{\BB}{\mathrm B}
\newcommand{\vph}{v_{\mathrm{ph}}}
$$</div></head><body class="book single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/>Neutrino Oscillations</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/emptymalei/neutrino-oscillations><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=/book/>Book</a></li><li class=nav-item><a class=nav-link href=http://docs.neutrino.xyz>Notes</a></li><li class=nav-item><a class=nav-link href=http://neutrino.xyz>neutrino.xyz</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>0. Abstract</h3><ul class=list-unstyled><li><a class=docs-link href=/book/abstract/>Abstract</a></li></ul><h3>1. Introduction</h3><ul class=list-unstyled><li><a class=docs-link href=/book/introduction/the-little-neutral-one/>The Little Neutral One</a></li><li><a class=docs-link href=/book/introduction/stellar-neutrinos/>Stellar Neutrinos</a></li><li><a class=docs-link href=/book/introduction/supernova-neutrinos/>Supernova Neutrinos</a></li><li><a class=docs-link href=/book/introduction/organization-of-the-book/>Organization of the Book</a></li></ul><h3>2. General Principle of Neutrino Oscillations</h3><ul class=list-unstyled><li><a class=docs-link href=/book/principles-of-neutrino-oscillations/principles-of-neutrino-oscillations/>General Principles of Neutrino Oscillations</a></li><li><a class=docs-link href=/book/principles-of-neutrino-oscillations/vacuum-oscillations/>Vacuum Oscillations</a></li><li><a class=docs-link href=/book/principles-of-neutrino-oscillations/neutrino-oscillations-in-matter/>Neutrino Oscillations in Matter</a></li><li><a class=docs-link href=/book/principles-of-neutrino-oscillations/neutrino-oscillations-in-the-sun/>Neutrino Oscillations in the Sun</a></li><li><a class=docs-link href=/book/principles-of-neutrino-oscillations/flavor-isospin-formalism/>Flavor Isospin Formalism</a></li></ul><h3>3. Neutrino Oscillations with Oscillatory Matter Profile</h3><ul class=list-unstyled><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/oscillations-with-oscillatory-matter-profiles/>Neutrino Oscillations with Oscillatory Matter Profiles</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/rabi-oscillations/>Rabi Oscillations</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/background-matter-basis/>Background Matter Basis</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/single-frequency-matter-profiles/>Single-Frequency Matter Profiles</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/multi-frequency-matter-profiles/>Multi-Frequency Matter Profiles</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/rabi-basis/>Rabi Basis</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/single-frequency-matter-profiles-revisited/>Single-Frequency Matter Profiles Revisited</a></li><li><a class=docs-link href=/book/oscillations-with-oscillatory-matter-profiles/multi-frequency-matter-profiles-revisited/>Multi-frequency Matter Profiles Revisited</a></li></ul><h3>4. Collective Neutrino Oscillations</h3><ul class=list-unstyled><li><a class=docs-link href=/book/collective-neutrino-oscillations/0_collective-neutrino-oscillations/>Collective Neutrino Oscillations</a></li><li><a class=docs-link href=/book/collective-neutrino-oscillations/1_equation-of-motion/>Equation of Motion</a></li><li><a class=docs-link href=/book/collective-neutrino-oscillations/2_two-beam-model-and-flavor-instabilities/>Two-Beam Model and Flavor Instabilities</a></li><li><a class=docs-link href=/book/collective-neutrino-oscillations/3_dispersion-relations/>Dispersion Relations</a></li><li><a class=docs-link href=/book/collective-neutrino-oscillations/4_flavor-instabilities-and-dispersion-relation-gaps/>Flavor Instabilities and Dispersion-Relation Gaps</a></li><li><a class="docs-link active" href=/book/collective-neutrino-oscillations/5_neutrino-oscillations-with-reflected-fluxes/>Neutrino Oscillations with Reflected Fluxes</a></li><li><a class=docs-link href=/book/collective-neutrino-oscillations/6_summary/>Summary</a></li></ul><h3>5. Conclusions and Future Work</h3><ul class=list-unstyled><li><a class=docs-link href=/book/conclusions-and-future-work/conclusions-and-future-work/>Conclusions and Future Work</a></li></ul><h3>Appendices</h3><ul class=list-unstyled><li><a class=docs-link href=/book/appendices/conventions/>Conventions</a></li><li><a class=docs-link href=/book/appendices/matter-interaction/>Neutrino Interaction with Matter</a></li><li><a class=docs-link href=/book/appendices/self-interactions/>Neutrino Self-interactions</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#two-beam-model-with-reflection>Two-Beam Model with Reflection</a></li><li><a href=#relaxation-method>Relaxation Method</a></li><li><a href=#validation-of-the-relaxation-method-with-relected-single-neutrino-beam>Validation of the Relaxation Method with Relected Single-Neutrino-Beam</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Neutrino Oscillations with Reflected Fluxes</h1><p class=lead></p><p>Most of the researches on supernova neutrino oscillations assumed that neutrinos are emitted from the spherical surface of a neutron star and that they are free streaming. In the real supernova environment, however, a small amount of neutrinos can be scattered back towards the neutron star. J. Cherry et al. showed that the &ldquo;neutrino halo&rdquo; formed by the scattered neutrino fluxes can change the neutrino self-interaction potential dramatically which may have an impact on neutrino oscillations in the supernova <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. In the section, I describe a toy model which can be used to explore the effect of the scattered neutrino fluxes on neutrino oscillations.</p><h2 id=two-beam-model-with-reflection>Two-Beam Model with Reflection<a href=#two-beam-model-with-reflection class=anchor aria-hidden=true>#</a></h2><p>I will consider the two-beam model depicted in Fig. <a href=/book/collective-neutrino-oscillations/two-beam-model-and-flavor-instabilities>Two-Beam Line Model</a> but with a &ldquo;neutrino mirror&rdquo; at $z=L$ that partially reflects the neutrino beams backward without changing their flavor content. The equations of motion for neutrino oscillations in this model are
$$
\begin{align}
\ri \sin\theta_i \partial_z \rho_i = & [ \mathsf H_i, \rho_i ] \qquad (i=1,2,3,4)
\end{align}
$$
where beams 1 and 2 contain neutrinos and antineutrinos, beams 3 and 4 are the reflected fluxes of 1 and 2, respectively, with $\theta_3=\theta_1$ and $\theta_4=\theta_2$. The Hamiltonians in the vacuum mass basis are
$$
\begin{align}
\mathsf H_1 =& -\eta \omega_\vv \sigma_3 + \mu( -\alpha \chi_- \rho_2 - \alpha \chi_+ R \rho_4 + \chi_1 R \rho_3), \\
\mathsf H_2 =& \eta \omega_\vv \sigma_3 + \mu( \chi_- \rho_1 -\alpha \chi_2 R \rho_4 + \chi_+ R \rho_3), \\
\mathsf H_3 =& -\eta \omega_\vv \sigma_3 + \mu( -\alpha R \chi_- \rho_4 -\alpha \chi_+ \rho_2 + \chi_1 \rho_1), \\
\mathsf H_4 =& \eta \omega_\vv \sigma_3 + \mu( R \chi_- \rho_3 + \chi_+ \rho_1 -\alpha \chi_2 \rho_2),
\end{align}
$$
where $\mu=\sqrt{2}G_{\mathrm F}n_1$ with $n_1$ being the number flux of beam 1, $\alpha=n_2/n_1$, $R$ is the reflection coefficient of the &ldquo;neutrino mirror&rdquo;, and
$$
\begin{align}
\chi_+ = & 1 - \cos ( \theta_1 + \theta_2 ), \\
\chi_- = & 1 - \cos ( \theta_1 - \theta_2 ), \\
\chi_1 = & 1 - \cos ( 2\theta_1 ), \\
    \chi_2 = & 1 - \cos ( 2\theta_2 ).
\end{align}
$$</p><h2 id=relaxation-method>Relaxation Method<a href=#relaxation-method class=anchor aria-hidden=true>#</a></h2><p>I developed a relaxation method to solve the two-beam model with reflection numerically. For the purpose of illustrating the algorithm, I denote the Hamiltonian using its components in flavor space:
$$
\begin{equation}
\mathsf H = -\sum_i \frac{H_i}{2}\sigma_i.
\end{equation}
$$
At position $z$, the evolution operator $\mathsf U(\Delta l,z)$ is
$$
\begin{align}
U(\Delta l, z) = \cos \left( \frac{H \Delta l}{2} \right) \mathsf I + \ri \left( \frac{H_1}{H} \sigma_1 + \frac{H_2}{H} \sigma_2 + \frac{H_3}{H} \sigma_3 \right) \sin \left( \frac{H \Delta l}{2} \right)
\end{align}
$$
where $\Delta l$ is the propagation distance along the neutrino trajectory between $z$ and the new position $z'$, and
$$
\begin{equation}
H = \sqrt{ H_1^2 + H_2^2 + H_3^2 }.
\end{equation}
$$
Then I calculate the density matrix at $z'$ as
$$
\begin{align}
\rho ( z' ) &= \mathscr F ( \mathsf H(z), \rho(z), \Delta l ) \\
&= \mathsf U (\Delta l, z) \rho(z)U^\dagger (\Delta l, z) \\
& = \frac{1}{4} \sum_j \left[  \cos( H \Delta l) \rho_j - \frac{2}{H^2} \sin^2 \left( \frac{H \Delta l}{2} \right) \sum_i H_i \rho_i H_j \right] \sigma_j.
\end{align}
$$
I discretize the $z$ axis into $N$ bins with $\Delta z = L/N$ and $z_n=n \Delta z$ ($n=0,1,\cdots, N$). I use the evolution operator $U_a(\Delta l, z)$ and the following iteration algorithm until I achieve numerical convergence.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 0
</span><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c++ data-lang=c++><span class=k>for</span> <span class=n>all</span> <span class=err>$</span><span class=n>a</span><span class=err>$</span><span class=p>,</span> <span class=err>$</span><span class=n>n</span><span class=err>$</span><span class=o>:</span> <span class=p>(</span><span class=err>#</span><span class=n>a</span> <span class=n>is</span> <span class=n>the</span> <span class=n>beam</span> <span class=n>index</span><span class=p>;</span> <span class=n>n</span> <span class=n>is</span> <span class=n>the</span> <span class=n>position</span> <span class=n>index</span><span class=p>)</span>
    <span class=err>$\</span><span class=n>rho</span><span class=o>^</span><span class=mi>0</span><span class=n>_a</span><span class=err>$</span> <span class=p>(</span><span class=err>$</span><span class=n>z_n</span><span class=err>$</span><span class=p>)</span> <span class=o>=</span> <span class=mi>0</span>
<span class=k>for</span> <span class=n>all</span> <span class=err>$</span><span class=n>a</span><span class=err>$</span><span class=o>:</span>
    <span class=err>$\</span><span class=n>rho</span><span class=o>^</span><span class=mi>0</span><span class=n>_a</span><span class=err>$</span> <span class=p>(</span><span class=err>$</span><span class=n>z_0</span><span class=err>$</span><span class=p>)</span> <span class=o>=</span> <span class=p>[</span> <span class=p>[</span> <span class=mi>1</span><span class=p>,</span> <span class=err>$\</span><span class=n>epsilon_a</span><span class=err>$</span> <span class=p>],</span> <span class=p>[</span> <span class=err>$\</span><span class=n>epsilon_a</span><span class=o>^*</span><span class=err>$</span><span class=p>,</span> <span class=mi>0</span> <span class=p>]</span> <span class=p>]</span>
<span class=err>$</span><span class=n>j</span><span class=err>$</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>(</span><span class=o>*</span><span class=err>@\</span><span class=n>textit</span><span class=p>{</span><span class=err>\#</span><span class=n>j</span> <span class=n>is</span> <span class=n>the</span> <span class=n>iteration</span> <span class=n>index</span><span class=p>}</span><span class=err>@</span><span class=o>*</span><span class=p>)</span>
<span class=k>do</span><span class=o>:</span>
    <span class=k>for</span> <span class=err>$</span><span class=n>a</span><span class=err>$</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span> <span class=n>and</span> <span class=err>$</span><span class=n>n</span><span class=err>$</span> <span class=o>&lt;</span> <span class=err>$</span><span class=n>N</span><span class=err>$</span><span class=o>:</span>
        <span class=err>$\</span><span class=n>rho_a</span><span class=o>^</span><span class=p>{</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=p>}</span><span class=err>$</span> <span class=p>(</span><span class=err>$</span><span class=n>z_</span><span class=p>{</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>}</span><span class=err>$</span><span class=p>)</span> <span class=o>=</span> <span class=err>$\</span><span class=n>mathscr</span><span class=p>{</span><span class=n>F</span><span class=p>}</span><span class=err>$</span><span class=p>(</span> <span class=err>$</span><span class=n>H</span><span class=o>^</span><span class=p>{</span><span class=n>j</span><span class=p>}</span><span class=n>_a</span><span class=err>$</span> <span class=p>(</span><span class=err>$</span><span class=n>z_n</span><span class=err>$</span><span class=p>),</span> <span class=err>$\</span><span class=n>rho_a</span><span class=o>^</span><span class=n>j</span><span class=err>$</span><span class=p>(</span><span class=err>$</span><span class=n>z_n</span><span class=err>$</span><span class=p>),</span> <span class=err>$\</span><span class=n>Delta</span> <span class=n>z</span><span class=o>/</span><span class=err>\</span><span class=n>sin</span> <span class=err>\</span><span class=n>theta_a</span><span class=err>$</span> <span class=p>)</span>
    <span class=k>for</span> <span class=err>$</span><span class=n>a</span><span class=err>$</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span> <span class=n>and</span> <span class=err>$</span><span class=n>n</span><span class=err>$</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>:</span>
        <span class=err>$\</span><span class=n>rho_a</span><span class=o>^</span><span class=p>{</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=p>}</span><span class=err>$</span> <span class=p>(</span><span class=err>$</span><span class=n>z_</span><span class=p>{</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>}</span><span class=err>$</span><span class=p>)</span> <span class=o>=</span> <span class=err>$\</span><span class=n>mathscr</span><span class=p>{</span><span class=n>F</span><span class=p>}</span><span class=err>$</span><span class=p>(</span> <span class=err>$</span><span class=n>H</span><span class=o>^</span><span class=p>{</span><span class=n>j</span><span class=p>}</span><span class=n>_a</span><span class=err>$</span> <span class=p>(</span><span class=err>$</span><span class=n>z_n</span><span class=err>$</span><span class=p>),</span> <span class=err>$\</span><span class=n>rho_a</span><span class=o>^</span><span class=n>j</span><span class=err>$</span><span class=p>(</span><span class=err>$</span><span class=n>z_n</span><span class=err>$</span><span class=p>),</span> <span class=err>$\</span><span class=n>Delta</span> <span class=n>z</span><span class=o>/</span><span class=err>\</span><span class=n>sin</span> <span class=err>\</span><span class=n>theta_a</span><span class=err>$</span> <span class=p>)</span>
    <span class=err>$</span><span class=n>j</span><span class=err>$</span> <span class=o>=</span> <span class=err>$</span><span class=n>j</span><span class=err>$</span> <span class=o>+</span> <span class=mi>1</span>
<span class=k>while</span> <span class=err>$\</span><span class=n>vert</span> <span class=err>\</span><span class=n>rho</span><span class=o>^</span><span class=p>{</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=p>}</span> <span class=o>-</span> <span class=err>\</span><span class=n>rho</span><span class=o>^</span><span class=p>{</span><span class=n>j</span><span class=p>}</span> <span class=err>\</span><span class=n>vert</span><span class=err>$</span> <span class=o>&gt;</span> <span class=n>error</span> <span class=n>tolerance</span>
</code></pre></td></tr></table></div></div><p>To speed up the calculations, I have parallelized the above algorithm with OpenMP.</p><h2 id=validation-of-the-relaxation-method-with-relected-single-neutrino-beam>Validation of the Relaxation Method with Relected Single-Neutrino-Beam<a href=#validation-of-the-relaxation-method-with-relected-single-neutrino-beam class=anchor aria-hidden=true>#</a></h2><p>As a check to the relaxation algorithm discussed in the previous subsection, I apply it to the single-beam model with reflection, i.e., $\theta_1=\pi/2$ and $\alpha=0$. As the first step of the validation of the numerical code, I compare the numerical and analytical results for the vacuum oscillations case with $R\to 0$ and the normal neutrino mass hierarchy. The results are shown in Fig. Validation Model.</p><figure><img src=../assets/validate-using-vacuum-r-0-mu-1.png alt="The validation of the numerical code for the single-beam model with $R\to 0$ and $L=1/\omega_\vv$. The markers and the continuous curves represent the numerical and analytical results, respectively." width=100%><figcaption><h4>Validation Model</h4><p>The validation of the numerical code for the single-beam model with $R\to 0$ and $L=1/\omega_\vv$. The markers and the continuous curves represent the numerical and analytical results, respectively.</p></figcaption></figure><p>To further validate the numerical code, I apply the linearized flavor stability analysis to the single-beam model with $R>0$ and compare it with the numerical results. The equation of motion in the linearized regime is
$$
\begin{align}
i\partial_z \begin{pmatrix}
\epsilon_{\mathrm F} \\
\epsilon_{\mathrm B}
\end{pmatrix} = \begin{pmatrix}
-\eta\omega_\vv + R \mu' & - R  \mu' \\
   \mu' & \eta\omega_\vv - \mu'
\end{pmatrix} \begin{pmatrix}
\epsilon_{\mathrm F} \\
\epsilon_{\mathrm B}
\end{pmatrix},
\label{chap:collective-sec:halo-eqn:linearized-eom-single-beam-model}
\end{align}
$$
where $\mu' = 2\mu$, and $\epsilon_\FF$ and $\epsilon_\BB$ are the off-diagonal elements of $\rho_1$ and $\rho_3$, respectively.
This equation can be easily solved. The neutrino gas has two collective modes with oscillation frequencies
$$
\begin{align}
\Omega_\pm &= \frac{1}{2} [ (R-1)\mu' \pm \sqrt{\Delta} ],
\end{align}
$$
where
$$
\begin{equation}
\Delta = (1-R)^2 \mu'^2 - 4\mu' \eta\omega_\vv (1+R) + 4\omega_\vv^2.
\end{equation}
$$
The corresponding eigenvectors are
$$
\begin{align}
V_\pm &= \frac{1}{2\mu'}\begin{pmatrix}
 { -2\eta\omega_\vv + \mu' (1+R) \pm \sqrt{\Delta} } \\
2\mu'
\end{pmatrix}.
\end{align}
$$
The general solution to the equation of motion is
$$
\begin{equation}
\begin{pmatrix}
\epsilon_{\mathrm F}(z) \\
\epsilon_{\mathrm B}(z)
\end{pmatrix} = C_+ V_+ e^{-i \Omega_+ z} + C_- V_- e^{-i \Omega_- z},
\label{chap:collective-sec:halo-eqn:linear-solution-general-solution}
\end{equation}
$$
where $C_\pm$ are constants. Using the fact that $\epsilon_F(L)=\epsilon_B(L)$ at the &ldquo;neutrino mirror&rdquo;, I obtain
$$
\begin{equation}
\frac{C_+}{C_-} = e^{-i(\Omega_- -\Omega_+)L} \frac{ \sqrt{\Delta} + 2\eta\omega_\vv + \mu' \ (1-R) }{\sqrt{\Delta} - 2\eta\omega_\vv - \mu' (1-R)}.
\label{chap:collective-sec:halo-eqn:linear-solution-general-solution-cp-cm-relations}
\end{equation}
$$
Combining Eqn.~\eqref{chap:collective-sec:halo-eqn:linear-solution-general-solution} and Eqn.~\eqref{chap:collective-sec:halo-eqn:linear-solution-general-solution-cp-cm-relations} I obtain
$$
\begin{equation}
\begin{pmatrix}
\epsilon_{\mathrm F}(z) \\
\epsilon_{\mathrm B}(z)
\end{pmatrix} = C_- e^{-i\Omega_- L} \left( \frac{ \sqrt{\Delta} + 2\eta\omega_\vv + \mu' (1-R) }{\sqrt{\Delta} - 2\eta\omega_\vv - \mu' (1-R)} V_+ e^{-i \Omega_+ (z-L)} + V_- e^{-i \Omega_- (z-L)} \right).
\end{equation}
$$</p><p>Since $\Delta &lt; 0$ when there exist flavor instabilities in the neutrino gas, I define $i\delta = \sqrt{\Delta}$. Therefore,
$$
\begin{align}
\left\vert \epsilon_{\mathrm F} \right\vert \propto & \lvert (2\eta\omega_\vv + \mu'(1-R) +i \delta ) ( -2\eta\omega_\vv + \mu'(1+R) + i \delta ) e^{\delta(z-L)} \nonumber\\
&+ ( -2\eta\omega_\vv - \mu'(1-R) +i \delta ) ( -2\eta\omega_\vv + \mu'(1+R) - i \delta ) e^{-\delta(z-L)} \rvert,
\label{chap:collective-sec:halo-eqn:linearized-eom-solution}
\end{align}
$$
which can be simplified as
$$
\begin{equation}
\left\vert \epsilon_{\mathrm F} \right\vert \propto A + B \cosh( 2\delta(L-z) )
\label{chap:collective-sec:halo-eqn:single-beam-linearized-solution}
\end{equation}
$$
with
$$
\begin{align}
A &= 8 \mu'^2 (\mu' - R - 2 \eta\omega_\vv )^2 + 8 \mu'^2 \Delta, \\
B &= 8 \mu'^2 (\mu' - R - 2 \eta\omega_\vv )^2 - 8 \mu'^2 \Delta .
\end{align}
$$
The only $z$ dependent term in Eqn.~\eqref{chap:collective-sec:halo-eqn:single-beam-linearized-solution} is $\cosh( 2\delta(L-z) )$, which decreases within $[0,L]$. In addition,
$$
\begin{equation}
\left. \frac{\dd \epsilon_\FF}{\dd z} \right \vert_{z=L} = \left. \frac{\dd \epsilon_\BB}{\dd z} \right \vert_{z=L} = 0.
\end{equation}
$$</p><figure><img src=../assets/thesis-mu-1-refl-0p07.png alt="The magnitudes of the off-diagonal elements of the density matrices of the forward and reflected neutrino beams as functions of distance $z$, respectively. The markers are the numerical results for the single-beam model with $\mu'= 1.0$, $R=0.07$, $L=5/\omega_\vv$, and the normal hierarchy. The continuous curves are the analytical results obtained from Eqn.~\eqref{chap:collective-sec:halo-eqn:linearized-eom-solution}." width=100%><figcaption><h4>Magnitudes of the Off-diagonal Elements</h4><p>The magnitudes of the off-diagonal elements of the density matrices of the forward and reflected neutrino beams as functions of distance $z$, respectively. The markers are the numerical results for the single-beam model with $\mu'= 1.0$, $R=0.07$, $L=5/\omega_\vv$, and the normal hierarchy. The continuous curves are the analytical results obtained from Eqn.~\eqref{chap:collective-sec:halo-eqn:linearized-eom-solution}.</p></figcaption></figure><p>For small values of $\epsilon_{\FF}$ and $\epsilon_\BB$, the solution from the linearized equation should represent the numerical calculations faithfully. In Fig. Magnitudes of the Off-diagonal Elements, I plotted the numerical result (dots) as well as the result from Eqn.~\eqref{chap:collective-sec:halo-eqn:single-beam-linearized-solution} (lines). It clearly shows that the linearized solution is a great match to the numerical result. This is also a method to validate the code.</p><p>In Fig. Magnitudes of the Off-diagonal Elements, I compare the numerical results obtained from the relaxation algorithm with the analytical results in Eqn.~\eqref{chap:collective-sec:halo-eqn:linearized-eom-solution} for the single-beam model with $\mu'= 1.0$, $R=0.07$, $L=5/\omega_\vv$, and the normal hierarchy. The good agreement between these results shows that the numerical code works as expected.</p><figure><img src=../assets/instability-regions.png alt="Instability regions for the normal hierarchy (left) and the inverted hierarchy (right) in the single-beam model with reflection. The color represents the magnitude of the imaginary component of the collective frequency." width=100%><figcaption><h4>Instability Regions</h4><p>Instability regions for the normal hierarchy (left) and the inverted hierarchy (right) in the single-beam model with reflection. The color represents the magnitude of the imaginary component of the collective frequency.</p></figcaption></figure><p>Comparing Eqn.~\eqref{chap:collective-sec:bipolar-linearized-eom} and Eqn.~\eqref{chap:collective-sec:halo-eqn:linearized-eom-single-beam-model}, one sees that the single-beam model with reflection is equivalent to the two-beam model without reflection except that the reflected neutrino beam now plays the role of the antineutrino, $R\to \alpha$, $\eta \to -\eta$, and $\mu' \to \mu$. Therefore, flavor instabilities should exist for the normal mass hierarchy in the single-beam-model with reflection (see Fig. Instability Regions).</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>John F. Cherry, "<span class=nocase>Neutrino scattering and flavor transformation in supernovae</span>", Physical Review Letters <span class=bold>108</span>, 1-5 (2012) .
<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section><p class=edit-page><a href=https://github.com/emptymalei/neutrino-oscillations/blob/master/content/book/collective-neutrino-oscillations/5_neutrino-oscillations-with-reflected-fluxes.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=/book/collective-neutrino-oscillations/4_flavor-instabilities-and-dispersion-relation-gaps/><div class="card my-1"><div class="card-body py-2">&larr; Flavor Instabilities and Dispersion-Relation Gaps</div></div></a><a class=ml-auto href=/book/collective-neutrino-oscillations/6_summary/><div class="card my-1"><div class="card-body py-2">Summary &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://www.netlify.com/>Netlify</a>, <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a>. Made with Love by <a href=https://leima.is>LM</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><li class=list-inline-item><a href=https://github.com/emptymalei/neutrino-oscillations>Source</a></li></ul></div></div></div></footer><script src=/main.8799b515b78eee3b29d8f279eaf6a5c8c66a08126ec6e57f3ac3e9375dc173d785de5c52ce63ea915ee4a59989cfc7485202af78f1915fd4041c3a982dccf2f0.js integrity="sha512-h5m1FbeO7jsp2PJ56valyMZqCBJuxuV/OsPpN13Bc9eF3lxSzmPqkV7kpZmJz8dIUgKvePGRX9QEHDqYLczy8A==" crossorigin=anonymous defer></script><script src=/index.min.36f19ee598cbf2bc1ebbab71f490f90ac1809123601b84ac21181e26412a283bcf7795a6728c9a337a0cf5bc54ac701f2830883e7a24a7b5de935d37413c35eb.js integrity="sha512-NvGe5ZjL8rweu6tx9JD5CsGAkSNgG4SsIRgeJkEqKDvPd5WmcoyaM3oM9bxUrHAfKDCIPnokp7Xek103QTw16w==" crossorigin=anonymous defer></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "20bf45690073452f9775b2b5670f1a88"}'></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RHC13N6MV9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-RHC13N6MV9');</script></body></html>